{
	http_port {$CADDY_PORT:-11111}
	admin off
	log {
		output stdout
		level INFO
	}
}

:{$CADDY_PORT} {
	# --- KasmVNC GUI Proxy ---
	handle_path /gui/* {
		reverse_proxy localhost:{$KASM_VNC_INTERNAL_PORT:-8443} {
			header_up X-Forwarded-Host {host}
			header_up X-Forwarded-Proto {scheme}
		}
	}

	# --- Log File Access ---
	handle_path /logs/* {
		file_server browse {
			root /app/logs  # Changed path
		}
	}

	# --- Root/Fallback Page ---
	handle {
		respond * 200 {
			body `<!DOCTYPE html>
<html>
<head><title>VisoMaster Portal (s-alt)</title></head>
<body>
<h1>VisoMaster Portal (s-alt)</h1>
<ul>
	<li><a href="/gui/">Access VisoMaster GUI (KasmVNC)</a></li>
	<li><a href="/logs/">Browse Application Logs</a></li>
</ul>
</body>
</html>`
			headers {
				Content-Type text/html
			}
		}
	}

	log
}